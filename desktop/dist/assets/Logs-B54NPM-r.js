import{u as E,b as S,j as e,B as m,c as h,C as O,e as T,I as F,S as G,h as B,i as j}from"./index-InTZOm33.js";import{r as a}from"./vendor-react-CckeeW4p.js";import{G as D,R as W,h as z,A as U,I as p,T as H,C as P}from"./vendor-ui-Dw6ShKlL.js";function M(){const{t}=E(),{success:w,error:L}=S(),[f,d]=a.useState([]),[c,R]=a.useState([]),[g,v]=a.useState(!1),[o,b]=a.useState(""),[n,y]=a.useState("ALL"),[l,C]=a.useState(!0),i=a.useRef(null),x=async()=>{try{v(!0);const s=await j.getLogs(1e3);d(s)}catch(s){console.error("Failed to fetch logs",s)}finally{v(!1)}},I=async()=>{try{await j.clearLogs(),d([]),d([]),w(t("logs.cleared"),t("logs.clearedDescription"))}catch(s){L(t("common.error"),String(s))}};a.useEffect(()=>{x();let s;return l&&(s=setInterval(x,2e3)),()=>clearInterval(s)},[l]),a.useEffect(()=>{let s=f;if(n!=="ALL"&&(s=s.filter(r=>r.level===n)),o){const r=o.toLowerCase();s=s.filter(u=>{var N;return u.message.toLowerCase().includes(r)||u.module.toLowerCase().includes(r)||((N=u.exception)==null?void 0:N.toLowerCase().includes(r))})}R(s)},[f,o,n]),a.useEffect(()=>{i.current&&l&&(i.current.scrollTop=i.current.scrollHeight)},[c,l]);const k=s=>{switch(s){case"ERROR":case"CRITICAL":return"text-red-600 dark:text-red-400";case"WARNING":return"text-yellow-600 dark:text-yellow-400";case"INFO":return"text-blue-600 dark:text-blue-400";case"DEBUG":return"text-gray-600 dark:text-gray-400";default:return"text-gray-800 dark:text-gray-200"}},A=s=>{switch(s){case"ERROR":case"CRITICAL":return e.jsx(P,{className:"w-4 h-4"});case"WARNING":return e.jsx(H,{className:"w-4 h-4"});case"INFO":return e.jsx(p,{className:"w-4 h-4"});default:return e.jsx("div",{className:"w-4 h-4"})}};return e.jsxs("div",{className:"container py-6 space-y-6 h-[calc(100vh-4rem)] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t("logs.title")}),e.jsx("p",{className:"text-muted-foreground",children:t("logs.subtitle")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:l?"primary":"outline",size:"sm",onClick:()=>C(!l),children:[e.jsx(D,{className:h("w-4 h-4 mr-2",l&&"animate-pulse")}),t(l?"logs.autoRefreshOn":"logs.autoRefreshOff")]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:x,disabled:g,children:[e.jsx(W,{className:h("w-4 h-4 mr-2",g&&"animate-spin")}),t("common.actions.refresh")]}),e.jsxs(m,{variant:"danger",size:"sm",onClick:I,children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),t("logs.clear")]})]})]}),e.jsxs(O,{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(T,{className:"py-3 px-4 border-b bg-muted/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(U,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:t("logs.searchPlaceholder"),value:o,onChange:s=>b(s.target.value),className:"pl-9 h-9"})]}),e.jsx("div",{className:"w-[150px]",children:e.jsx(G,{value:n,onChange:s=>y(s.target.value),options:[{value:"ALL",label:t("logs.levels.all")},{value:"INFO",label:"INFO"},{value:"WARNING",label:"WARNING"},{value:"ERROR",label:"ERROR"},{value:"DEBUG",label:"DEBUG"}]})}),e.jsxs("div",{className:"ml-auto text-xs text-muted-foreground",children:[c.length," ",t("logs.entries")]})]})}),e.jsx(B,{className:"p-0 flex-1 overflow-auto bg-black/90 text-primary-foreground font-mono text-xs",ref:i,children:c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[e.jsx(p,{className:"w-8 h-8 mb-2 opacity-50"}),e.jsx("p",{children:t("logs.noLogs")})]}):e.jsx("div",{className:"divide-y divide-gray-800",children:c.map((s,r)=>e.jsxs("div",{className:"flex gap-4 p-2 hover:bg-white/5 transition-colors",children:[e.jsx("div",{className:"shrink-0 text-gray-500 w-32 tabular-nums",children:new Date(s.timestamp).toLocaleTimeString()}),e.jsxs("div",{className:h("shrink-0 w-16 font-bold flex items-center gap-1",k(s.level)),children:[A(s.level),s.level]}),e.jsxs("div",{className:"flex-1 break-all",children:[e.jsxs("span",{className:"text-gray-400 mr-2",children:["[",s.module,"]"]}),s.message,s.exception&&e.jsx("pre",{className:"mt-1 p-2 bg-red-900/20 text-red-300 rounded overflow-x-auto",children:s.exception})]})]},r))})})]})]})}export{M as default};
